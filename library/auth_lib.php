<?phpfunction match_passwords($loginPass , $registerPass){    return $loginPass === $registerPass ;}function get_user_by_email($email){    $sql = "select * from users where email = :email";    $record = doSelect($sql , ['email' => $email]);    return $record[0];}function hash_progress($password){    return hash('sha256' , $password);}function authenticate(object $user){    $_SESSION['login'] = $user;}function auth_id(){    return $_SESSION['login']->id;}function auth(){    return $_SESSION['login'];}function auth_check(){     return isset($_SESSION['login']);}function Request_Method(){    return $_SERVER['REQUEST_METHOD'];}function register($params){    $sql = "insert into users (name , email , password) values (:name , :email , :password)";    return doQuery($sql ,        ['name' => $params->username ,        'email' => $params->email ,        'password' => hash_progress($params->password)        ]);}function login($params){    $user = get_user_by_email($params->email);    $password = hash_progress($params->password);    if(match_passwords($password , $user->password))    {        authenticate($user);        redirect_to(route());        return true;    }    return false;}function logout(){    unset($_SESSION['login']);}